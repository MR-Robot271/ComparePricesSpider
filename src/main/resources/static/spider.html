<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>数据爬取</title>
    <link rel="stylesheet" type="text/css" href="spiderStyle.css">
</head>
</head>
<body>
<div>
    <button onclick="xiyuspider()">爬取西域</button>
    <button onclick="zkhspider()">爬取震坤行</button>
    <br>
</div>

<!--西域进度条-->
<div id="xiyu-progress-container">
    <div>
        西域爬取进度：
    </div>
    <div id="xiyu-progress">
        <div id="xiyu-progress-bar" style="width: 0%;"></div>
        <span id="xiyu-progress-label"></span>
    </div>
</div>

<!--震坤行进度条-->
<div id="zkh-progress-container">
    <div>
        震坤行爬取进度：
    </div>
    <div id="zkh-progress">
        <div id="zkh-progress-bar" style="width: 0%;"></div>
        <span id="zkh-progress-label"></span>
    </div>
</div>

<script>
    // 声明 WebSocket 变量
    let socket;
    const progressBar = document.getElementById('xiyu-progress-bar');
    const progressLabel = document.getElementById('xiyu-progress-label');

    // 西域 连接 WebSocket 并接收后端数据
    function connectWebSocket() {
        socket = new WebSocket('ws://localhost:8888/websocket'); // 这里是您后端的 WebSocket 端点路径

        socket.onmessage = function (event) {
            const data = JSON.parse(event.data);
            const crawledNum = data.crawledNum;
            const totalNum = data.totalNum;

            // 计算并更新页面显示的进度条
            const progress = (crawledNum / totalNum) * 100; // 计算进度百分比
            // 更新页面中显示进度条的元素
            // ...
            progressBar.style.width = `${progress}%`; // 更新进度条宽度
            progressLabel.textContent = `${progress.toFixed(2)}%`; // 更新百分比标签内容
            // window.alert(progress);
            // console.log(progress);
        };

        socket.onerror = function (error) {
            console.error('WebSocket error:', error);
        };

        socket.onclose = function (event) {
            console.log('WebSocket closed:', event);
        };
    }

    // 调用西域爬虫接口
    function xiyuspider() {
        connectWebSocket();
        fetch('/file/xiyuSpider', {
            method: 'GET' // 或者其他 HTTP 方法，比如 POST、PUT 等
            // 可以添加 headers、body 等选项
        })
            .then(response => {
                return response.json();
            })
            .then(data => {
                console.log('Received data from backend:', data);
                // 在这里处理后端返回的数据

            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
    }

    // 声明 WebSocket 变量
    let zkhSocket;
    const zkhProgressBar = document.getElementById('zkh-progress-bar');
    const zkhProgressLabel = document.getElementById('zkh-progress-label');
    function connectZkhWebSocket() {
        zkhSocket = new WebSocket('ws://localhost:8888/websocket'); // 这里是您后端的 WebSocket 端点路径

        zkhSocket.onmessage = function (event) {
            const data = JSON.parse(event.data);
            const crawledNum = data.crawledNum;
            const totalNum = data.totalNum;

            // 计算并更新页面显示的进度条
            const progress = (crawledNum / totalNum) * 100; // 计算进度百分比
            // 更新页面中显示进度条的元素
            // 更新进度条宽度
            zkhProgressBar.style.width = `${progress}%`;
            // 更新百分比标签内容
            zkhProgressLabel.textContent = `${progress.toFixed(2)}%`;
        }
    }

    // 调用震坤行爬虫接口
    function zkhspider() {
        connectZkhWebSocket();
        fetch('/file/zkhSpider', {
            method: 'GET' // 或者其他 HTTP 方法，比如 POST、PUT 等
            // 可以添加 headers、body 等选项
        })
            .then(response => {
                return response.json();
            })
            .then(data => {
                console.log('Received data from backend:', data);
                // 在这里处理后端返回的数据
            })
            .catch(error => {
                console.error('There was a problem with the fetch operation:', error);
            });
    }

    // 从springboot后端中WebMagic的ExcelPipeline的writeToExcel方法发送数据到前端，数据为：已爬取数量和总数量，类型都为int，前后端数据的传输使用websocket，根据这两个数据在前端实时显示进度条。调用WebMagic爬虫的controller方法是public void xiyuSpider()，请问应该怎么实现，具体的代码是什么
</script>
</body>
</html>